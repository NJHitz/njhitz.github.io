<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NJ HITZ Teams & Player Profiles</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet" />

  <link href="css/main.css" rel="stylesheet">
  <style>
    .filters-row{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      margin-bottom:18px;
      font-size:.9rem;
    }
    .filters-row label{
      display:flex;
      align-items:center;
      gap:6px;
    }
    .filters-row select{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid #333;
      background:#14141a;
      color:var(--hitz-white);
      font-size:.9rem;
    }

    .teams-list{
      display:flex;
      flex-direction:column;
      gap:20px;
    }
    .team-card{
      background:radial-gradient(120% 140% at 100% 0,rgba(179,139,53,.14),transparent 55%),#141418;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.08);
      padding:18px 16px 18px;
      box-shadow:0 10px 24px rgba(0,0,0,.45);
    }
    @media (min-width:768px){
      .team-card{
        padding:20px 20px 22px;
      }
    }

    .team-header{
      display:flex;
      flex-wrap:wrap;
      justify-content:space-between;
      gap:8px 14px;
      margin-bottom:10px;
      border-bottom:1px solid rgba(255,255,255,.08);
      padding-bottom:8px;
    }
    .team-title{
      font-size:1.1rem;
      font-weight:800;
      letter-spacing:.04em;
      text-transform:uppercase;
    }
    .team-meta{
      font-size:.9rem;
      color:#c7c7d6;
    }

    .coaches{
      margin:8px 0 12px;
      font-size:.9rem;
    }
    .coaches strong{
      color:var(--hitz-gold);
      font-weight:700;
    }
    .coaches-list{
      display:flex;
      flex-wrap:wrap;
      gap:6px 12px;
      margin-top:4px;
    }
    .coach-pill{
      padding:4px 10px;
      border-radius:999px;
      background:#1a1a22;
      border:1px solid rgba(255,255,255,.12);
      font-size:.85rem;
      white-space:nowrap;
    }

    .roster-title{
      font-size:.9rem;
      text-transform:uppercase;
      letter-spacing:.12em;
      color:#bfbfd1;
      margin-bottom:4px;
      margin-top:4px;
    }

    .roster-table{
      width:100%;
      border-collapse:collapse;
      font-size:.9rem;
      background:#15151b;
      border-radius:12px;
      overflow:hidden;
      table-layout:fixed;
    }
    .roster-table thead{
      background:rgba(20,20,30,.9);
    }
    .roster-table th,
    .roster-table td{
      padding:6px 8px;
      border-bottom:1px solid rgba(255,255,255,.04);
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .roster-table th{
      text-align:left;
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:.12em;
      font-size:.75rem;
      color:#e0e0ee;
    }
    .roster-table tbody tr:nth-child(even){
      background:rgba(255,255,255,.02);
    }
    .roster-table a{
      color:var(--hitz-gold);
      font-weight:600;
      text-decoration:none;
    }
    .roster-table a:hover{
      text-decoration:underline;
    }

    .roster-table col.col-num  { width: 10%; }
    .roster-table col.col-name { width: 50%; }
    .roster-table col.col-pos  { width: 20%; }
    .roster-table col.col-grad { width: 20%; }

    .empty-message{
      font-size:.9rem;
      color:#b0b0c3;
      font-style:italic;
      margin-top:6px;
    }
  </style>
</head>

<body>
  <!-- Shared site header -->
  <header class="site-header" id="header"></header>

  <div class="page-container">
    <section class="hero">
      <div class="hero-inner">
        <div class="hero-eyebrow">NJ HITZ SOFTBALL</div>
        <h1>Program Teams & Rosters</h1>
        <p>
          Browse current NJ HITZ teams, coaching staff, and full player rosters.
          Click a player’s name to view their full showcase profile with stats, academics, and contact info.
        </p>
      </div>
    </section>

    <main>
      <div class="content">
        <p class="page-intro">
          This page is fully data-driven. Team, coach, and roster information are loaded from
          <code>data/teams.json</code>, and each player link opens their
          <code>player.html</code> showcase using a URL parameter.
        </p>

        <div class="filters-row">
          <label>
            Filter by Grad Year:
            <select id="grad-filter">
              <option value="">All</option>
            </select>
          </label>
        </div>

        <div id="teams-container" class="teams-list"></div>

        <div id="teams-error" class="empty-message" style="display:none;margin-top:16px;">
          Unable to load teams data. Please check that <code>data/teams.json</code> is uploaded and valid.
        </div>
      </div>
    </main>

    <div id="footer"></div>
    <!--
    <footer>
      © <span id="year"></span> NJ HITZ Softball — Player Showcase
    </footer>
    -->
  </div>

  <script>
    (function(){
      //document.getElementById('year').textContent = new Date().getFullYear();

      const teamsContainer = document.getElementById('teams-container');
      const errorEl = document.getElementById('teams-error');
      const gradFilter = document.getElementById('grad-filter');
      let allTeams = [];

      const LEVEL_ORDER = {
        '18U': 0,
        '16U': 1,
        '14U': 2,
        '12U': 3
      };

      function sortTeams(teams){
        return teams.slice().sort((a,b) => {
          const la = (a.level || '').toUpperCase();
          const lb = (b.level || '').toUpperCase();
          const oa = LEVEL_ORDER.hasOwnProperty(la) ? LEVEL_ORDER[la] : 99;
          const ob = LEVEL_ORDER.hasOwnProperty(lb) ? LEVEL_ORDER[lb] : 99;
          if (oa !== ob) return oa - ob;
          return (a.name || '').localeCompare(b.name || '');
        });
      }

      function renderTeams(filterGradYear){
        teamsContainer.innerHTML = '';

        let baseTeams = allTeams;
        if (filterGradYear) {
          baseTeams = allTeams.map(team => ({
            ...team,
            roster: (team.roster || []).filter(p => String(p.gradYear || '') === String(filterGradYear))
          })).filter(team => team.roster && team.roster.length);
        }

        const teamsToRender = sortTeams(baseTeams);

        if(!teamsToRender.length){
          const msg = document.createElement('div');
          msg.className = 'empty-message';
          msg.textContent = 'No teams / players match the selected filter yet.';
          teamsContainer.appendChild(msg);
          return;
        }

        teamsToRender.forEach(team => {
          const card = document.createElement('article');
          card.className = 'team-card';

          const header = document.createElement('div');
          header.className = 'team-header';

          const title = document.createElement('div');
          title.className = 'team-title';
          title.textContent = team.name || 'NJ HITZ Team';

          const meta = document.createElement('div');
          meta.className = 'team-meta';
          const season = team.season ? `Season: ${team.season}` : '';
          const level = team.level ? (season ? ` • Level: ${team.level}` : `Level: ${team.level}`) : '';
          meta.textContent = season + level;

          header.appendChild(title);
          header.appendChild(meta);
          card.appendChild(header);

          if(team.coaches && team.coaches.length){
            const coachesBlock = document.createElement('div');
            coachesBlock.className = 'coaches';

            const label = document.createElement('strong');
            label.textContent = 'Coaches:';
            coachesBlock.appendChild(label);

            const list = document.createElement('div');
            list.className = 'coaches-list';

            team.coaches.forEach(coach => {
              const pill = document.createElement('div');
              pill.className = 'coach-pill';
              const role = coach.role ? ` — ${coach.role}` : '';
              pill.textContent = (coach.name || 'Coach') + role;
              list.appendChild(pill);
            });

            coachesBlock.appendChild(list);
            card.appendChild(coachesBlock);
          }

          const rosterTitle = document.createElement('div');
          rosterTitle.className = 'roster-title';
          rosterTitle.textContent = 'Roster';
          card.appendChild(rosterTitle);

          if(team.roster && team.roster.length){
            const table = document.createElement('table');
            table.className = 'roster-table';

            const colgroup = document.createElement('colgroup');
            ['col-num','col-name','col-pos','col-grad'].forEach(cls => {
              const col = document.createElement('col');
              col.className = cls;
              colgroup.appendChild(col);
            });
            table.appendChild(colgroup);

            const thead = document.createElement('thead');
            thead.innerHTML = `
              <tr>
                <th>#</th>
                <th>Player</th>
                <th>Pos</th>
                <th>Grad</th>
              </tr>`;
            table.appendChild(thead);

            const tbody = document.createElement('tbody');

            team.roster.forEach(player => {
              const tr = document.createElement('tr');

              const tdNum = document.createElement('td');
              tdNum.textContent = player.number != null ? player.number : '';
              tr.appendChild(tdNum);

              const tdName = document.createElement('td');
              if(player.slug){
                const link = document.createElement('a');
                link.href = `player.html?player=${encodeURIComponent(player.slug)}`;
                link.textContent = player.name || 'Player';
                tdName.appendChild(link);
              } else {
                tdName.textContent = player.name || 'Player';
              }
              tr.appendChild(tdName);

              const tdPos = document.createElement('td');
              tdPos.textContent = Array.isArray(player.positions) ? player.positions.join(', ') : (player.positions || '');
              tr.appendChild(tdPos);

              const tdGrad = document.createElement('td');
              tdGrad.textContent = player.gradYear || '';
              tr.appendChild(tdGrad);

              tbody.appendChild(tr);
            });

            table.appendChild(tbody);
            card.appendChild(table);
          } else {
            const empty = document.createElement('div');
            empty.className = 'empty-message';
            empty.textContent = 'Roster coming soon.';
            card.appendChild(empty);
          }

          teamsContainer.appendChild(card);
        });
      }

      function populateGradFilter(){
        const years = new Set();
        allTeams.forEach(team => {
          (team.roster || []).forEach(p => {
            if(p.gradYear) years.add(String(p.gradYear));
          });
        });
        const sorted = Array.from(years).sort();
        sorted.forEach(y => {
          const opt = document.createElement('option');
          opt.value = y;
          opt.textContent = y;
          gradFilter.appendChild(opt);
        });
      }

      gradFilter.addEventListener('change', () => {
        renderTeams(gradFilter.value || '');
      });

      fetch('data/teams.json', {cache:'no-cache'})
        .then(resp => resp.json())
        .then(data => {
          allTeams = (data && data.teams) ? data.teams : [];
          if(!allTeams.length){
            throw new Error('No teams found in JSON');
          }
          populateGradFilter();
          renderTeams('');
        })
        .catch(err => {
          console.error('Error loading teams.json:', err);
          errorEl.style.display = 'block';
        });
    })();
  </script>

  <script src="scripts/template-loader.js"></script>
</body>
</html>
